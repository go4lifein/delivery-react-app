{"version":3,"sources":["components/UI/ConfirmAndSubmitButton.js","components/utils/CSVUploadAndPreview.js","api/delivery.js","api/api.js","components/Customer/DeliveryInstructions.js"],"names":["ConfirmAndSubmitButton","onSubmit","onCancel","label","message","confirmLabel","cancelLabel","alertTitle","props","React","useState","showAlert","setShowAlert","Dialog","open","onClose","aria-labelledby","aria-describedby","DialogTitle","id","DialogContent","DialogContentText","DialogActions","Button","onClick","color","variant","autoFocus","parseOptions","header","dynamicTyping","skipEmptyLines","transformHeader","replace","CSVUploadAndPreview","hints","papaparseOptions","validator","maxLength","filterDataCallback","mapDataCallback","tableProps","csvData","setData","showData","toggleData","fileInfo","setFileInfo","undefined","columns","setColumns","error","setError","className","cssClass","style","fontSize","marginRight","onFileLoaded","data","filter","map","firstItem","length","keys","Object","key","name","selector","width","sortable","hadError","parseInt","forEach","item","err","console","log","updateCSV","cssLabelClass","cssInputClass","parserOptions","fullScreen","padding","backgroundColor","borderRadius","Alert","severity","e","disabled","Boolean","Divider","fixedHeader","noHeader","pagination","deliveryApi","api","addDriverData","putRequest","path","updateDeliveryInstructions","instructions","postRequest","getCustomersWithInstructions","get","this","config","getRequestParam","param","a","Promise","resolve","reject","request","url","method","params","then","res","catch","store","dispatch","enqueueAPIErrorSnackbar","setRequestAuthHeader","accessToken","axios","defaults","headers","common","create","formData","post","baseURL","API_URL","timeout","DeliveryInstructions","refreshData","setState","customers","filterData","state","search","includes","phone","onSearch","target","value","response","enqueueSnackbar","validateInstructions","instructionRecord","instruction","Error","filterValidInstructions","loading","Loading","title","actions","TextField","onChange","progressComponent","Component","withSnackbar"],"mappings":"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","file":"static/js/44.cbb7f295.chunk.js","sourcesContent":["import React from 'react';\nimport Dialog from '@material-ui/core/Dialog';\nimport Button from '@material-ui/core/Button';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\n\nfunction ConfirmAndSubmitButton({\n  onSubmit,\n  onCancel,\n  label = \"Submit\",\n  message = \"Are you sure you want to proceed?\",\n  confirmLabel = \"Yes, proceed\",\n  cancelLabel = \"Cancel\",\n  alertTitle,\n  ...props\n}) {\n  const [showAlert, setShowAlert] = React.useState(false);\n\n  return (\n    <div>\n      <Dialog\n        open={showAlert}\n        onClose={() => setShowAlert(false)}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        \n        {alertTitle && <DialogTitle id=\"alert-dialog-title\">{alertTitle}</DialogTitle>}\n        <DialogContent>\n          <DialogContentText id=\"alert-dialog-description\">\n            {message}\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onCancel} color=\"primary\">\n            {cancelLabel}\n          </Button>\n          <Button onClick={onSubmit} color=\"primary\" variant=\"contained\" autoFocus>\n            {confirmLabel}\n          </Button>\n        </DialogActions>\n        \n      </Dialog>\n      <Button \n        variant=\"contained\"\n        color=\"primary\"\n        {...props}\n        onClick={() => setShowAlert(true)}\n      >\n        {label}\n      </Button>\n    </div>\n  );\n}\n\nexport default ConfirmAndSubmitButton;","import React, { useState } from 'react'\nimport CSVReader from 'react-csv-reader'\nimport DataTable from 'react-data-table-component';\nimport './css/csvStyles.css';\nimport Alert from '@material-ui/lab/Alert'\nimport UploadIcon from '@material-ui/icons/CloudUpload'\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport ConfirmAndSubmitButton from '../UI/ConfirmAndSubmitButton';\nimport Button from '@material-ui/core/Button';\nimport Divider from '@material-ui/core/Divider';\n\nconst parseOptions = {\n\theader: true,\n\tdynamicTyping: true,\n\tskipEmptyLines: true,\n\ttransformHeader: header => header.replace(/\\W/g, \"_\")\n};\n\n/**\n * ## CSVUploadAndPreview\n * \n * * `validator`: a function that validates and throws an error if data is not correct\n * * `mapDataCallback`: a function that is used as a callback for `data.map(mapDataCallback)`\n */\nfunction CSVUploadAndPreview({\n\thints, \n\tlabel = \"Upload File\", \n\tpapaparseOptions = parseOptions,\n\tvalidator,\n\tmaxLength,\n\tfilterDataCallback,\n\tmapDataCallback,\n\ttableProps = {\n\t\tpagination: true\n\t},\n\tonSubmit,\n\t...props\n}) {\n\n\tconst [csvData, setData] = useState([]);\n\tconst [showData, toggleData] = useState(false);\n\tconst [fileInfo, setFileInfo] = useState(null);\n\tconst [columns, setColumns] = useState(undefined)\n\tconst [error, setError] = useState(null)\n\n\tconst updateCSV = (data) => {\n\n\t\tif(filterDataCallback) data = data.filter(filterDataCallback);\n\n\t\tif(mapDataCallback) {\n\t\t\tdata = data.map(mapDataCallback);\n\t\t}\n\t\t\n\t\tlet firstItem = {};\n\t\tif (data.length) firstItem = data[0];\n\n\t\tlet keys = Object.keys(firstItem).map(key => ({\n\t\t\tname: key,\n\t\t\tselector: key,\n\t\t\twidth: '200px',\n\t\t\tsortable: true\n\t\t}));\n\n\n\t\tlet hadError = false;\n\t\tif(maxLength) {\n\t\t\thadError = true;\n\t\t\tmaxLength = parseInt(maxLength)\n\t\t\tif(data.length > maxLength) {\n\t\t\t\tsetError(`Total number of records can't exceed ${maxLength}. You added ${data.length}.`);\n\t\t\t}\n\t\t}\n\t\tif(validator) {\n\t\t\tdata.forEach(item => {\n\t\t\t\ttry {\n\t\t\t\t\tvalidator(item);\n\t\t\t\t} catch(err) {\n\t\t\t\t\tconsole.log(item);\n\t\t\t\t\thadError = true;\n\t\t\t\t\tsetError(err.message);\n\t\t\t\t}\n\t\t\t})\n\t\t\tif(!hadError) {\n\t\t\t\tsetError(null);\n\t\t\t}\n\t\t}\n\n\t\tsetColumns(keys);\n\t\tsetData(data);\n\t\ttoggleData(true);\n\t}\n\n\tconst handleFileUpload = (data, fileInfo) => {\n\t\tupdateCSV(data);\n\t\tsetFileInfo(fileInfo);\n\t}\n\n\tconst onConfirmUpdate = (e) => {\n\t\tif(onSubmit) onSubmit(csvData);\n\t\ttoggleData(false);\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t<div className=\"flex middle\">\n\t\t\t\t<CSVReader\n\t\t\t\t\tcssClass=\"csv-reader-input\"\n\t\t\t\t\tlabel={<div className=\"flex center middle\" style={{fontSize: 16}}> <UploadIcon style={{marginRight: 8}} /> {label}</div>}\n\t\t\t\t\tonFileLoaded={handleFileUpload}\n\t\t\t\t\tcssLabelClass=\"csv-input-label\"\n\t\t\t\t\tcssInputClass=\"csv-input\"\n\t\t\t\t\tparserOptions={papaparseOptions}\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t{showData && <Dialog fullScreen open={showData}>\n\t\t\t\t<DialogTitle>\n\t\t\t\t\t<div className=\"flex space-bw middle\">\n\t\t\t\t\t\t<div>Preview Data - <span style={{padding: 4, backgroundColor: 'lightgreen', borderRadius: 4}}>{fileInfo && fileInfo.name}</span></div>\n\t\t\t\t\t\t<div className=\"flex middle\">\n\t\t\t\t\t\t{error && <Alert variant=\"standard\" severity=\"error\">\n\t\t\t\t\t\t\t{error}\n\t\t\t\t\t\t</Alert>}\n\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t<ConfirmAndSubmitButton \n\t\t\t\t\t\t\t\tonSubmit={onConfirmUpdate}\n\t\t\t\t\t\t\t\tdisabled={Boolean(error)}\n\t\t\t\t\t\t\t\tonCancel={() => toggleData(false)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tSubmit\n\t\t\t\t\t\t\t</ConfirmAndSubmitButton>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t<Button onClick={() => toggleData(false)}>\n\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</DialogTitle>\n\t\t\t\t<Divider />\n\t\t\t\t<DialogContent>\n\t\t\t\t\t<DataTable\n\t\t\t\t\t\tfixedHeader={true}\n\t\t\t\t\t\tnoHeader={true}\n\t\t\t\t\t\tcolumns={columns}\n\t\t\t\t\t\tdata={csvData}\n\t\t\t\t\t\tpagination={true}\n\t\t\t\t\t/>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>}\n\t\t</div>\n\t)\n}\n\nexport default CSVUploadAndPreview\n","import api from './api';\n\nclass DeliverApi {\n  constructor(api) {\n    this.api = api;\n    this.path = '/delivery'\n  }\n  addDriverData = (data) => {\n    return this.api.putRequest(this.path + `/addDeliveryPerson`, data);\n  }\n  updateDeliveryInstructions = (instructions = []) => {\n    return this.api.postRequest(this.path + `/updateDeliveryInstructions`, {instructions});\n  }\n  getCustomersWithInstructions = () => {\n    return this.api.get(this.path + `/getCustomersWithInstructions`);\n  }\n}\n\nconst deliveryApi = new DeliverApi(api);\n\nexport default deliveryApi;","import axios from 'axios';\nimport {enqueueAPIErrorSnackbar} from '../reducers/notifier';\nimport store from '../store';\nimport {API_URL} from '../helpers/utils';\n\nexport class API {\n  constructor(config) {\n    this.api = axios.create(config);\n  }\n  getRequestParam = async (path, param) => {\n    return new Promise((resolve, reject) => {\n      this.api.request({\n        url: path,\n        method: 'get',\n        params: param\n      })\n      .then(res => resolve(res.data))\n      .catch(err => {\n        store.dispatch(enqueueAPIErrorSnackbar(err));\n        reject(err);\n      });\n    })\n  }\n  get = (path) => {\n    return new Promise((resolve, reject) => {\n      this.api.request({\n        url: path,\n        method: 'get'\n      })\n      .then(res => resolve(res.data))\n      .catch(err => {\n        store.dispatch(enqueueAPIErrorSnackbar(err));\n        reject(err);\n      });\n    })\n  }\n  postRequest = (url, data) => {\n    return new Promise((resolve, reject) => {\n      this.api.request({\n        url: url,\n        method: 'post',\n        data\n      })\n      .then(res => resolve(res.data))\n      .catch(err => {\n        store.dispatch(enqueueAPIErrorSnackbar(err));\n        reject(err);\n      });\n    })\n  }\n  putRequest(url, data) {\n    return new Promise((resolve, reject) => {\n      this.api.request({\n        url: url,\n        method: 'put',\n        data\n      })\n      .then(res => resolve(res.data))\n      .catch(err => {\n        store.dispatch(enqueueAPIErrorSnackbar(err));\n        reject(err);\n      });\n    })\n  }\n  postFormData(url, formData) {\n    return new Promise((resolve, reject) => {\n      this.api.post(url, {\n        data: formData,\n        headers: { 'Content-type': 'multipart/form-data' }\n      })\n      .then(res => resolve(res.data))\n      .catch(err => {\n        store.dispatch(enqueueAPIErrorSnackbar(err));\n        reject(err);\n      });\n    })\n  }\n  setRequestAuthHeader = (key = \"x-admin-token\", accessToken) => {\n    axios.defaults.headers.common[key] = accessToken;\n  }\n}\n\nconst api = new API({\n  baseURL: API_URL,\n  headers: {\n    'Content-Type': 'application/json',\n    timeout: 500\n  }\n});\n\nexport default api;","import React, { Component } from 'react';\nimport { TextField } from '@material-ui/core';\nimport { withSnackbar } from 'notistack';\nimport DataTable from \"react-data-table-component\";\nimport Loading from '../Loading';\nimport CSVUpload from '../utils/CSVUploadAndPreview';\n\nimport deliveryApi from \"../../api/delivery\";\n\nclass DeliveryInstructions extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      name: \"\",\n      phone: \"\",\n      search: \"\",\n      customers: [],\n    }\n  }\n  componentDidMount() {\n    this.setState({\n      loading: false,\n    })\n    this.refreshData()\n  }\n  refreshData = async () => {\n    const data = await deliveryApi.getCustomersWithInstructions();\n    this.setState({\n      customers: data\n    })\n  }\n  filterData = () => {\n    let {search, customers} = this.state;\n    let data = [];\n    if (customers) {\n      data = customers.filter((item) => {\n        if (!item.name.includes(search) && !item.phone.includes(search))\n          return false;\n        return true;\n      })\n    }\n    return data;\n  }\n  columns = [\n    {\n      name: \"Customer\",\n      selector: 'name',\n      sortable: true,\n      width: '300px',\n\n    },\n    {\n      name: \"Instruction\",\n      selector: 'delivery_instruction',\n      sortable: true,\n      width: '300px'\n    }\n  ]\n\n  onSearch = (e) => {\n    this.setState({\n      search: e.target.value\n    })\n  }\n  updateDeliveryInstructions = (instructions) => {\n    deliveryApi.updateDeliveryInstructions(instructions)\n    .then(response => {\n        this.props.enqueueSnackbar(response, {\n        variant: 'success'\n      });\n    });\n  }\n  validateInstructions = (instructionRecord) => {\n    const {id, instruction} = instructionRecord;\n    if(!id) throw new Error(\"Column id is compulsory.\");\n    if(!instruction) throw new Error(\"Column instruction is compulsory.\");\n  }\n  filterValidInstructions = ({instruction, id}) => {\n    if(!id) return false;\n    if(!instruction) return false;\n    return true;\n  }\n  render() {\n    const { loading,  } = this.state;\n    let data = this.filterData();\n\n    if (loading) {\n      return <Loading />\n    }\n\n    return (\n      <div>\n        <DataTable\n          title={\"Customer Delivery Instructions\"}\n          actions={\n            <>\n              <div>\n                <TextField\n                  label=\"Search by Name or Phone\"\n                  value={this.state.search}\n                  onChange={this.onSearch}\n    \n                />\n              </div>\n              <div>\n                <CSVUpload \n                  label={\"Upload Delivery Instructions\"}\n                  maxLength={400}\n                  filterDataCallback={this.filterValidInstructions}\n                  validator={this.validateInstructions}\n                  mapDataCallback={({id, instruction}) => {\n                    instruction = instruction.replace(\"'\", '');\n                    return {id, instruction}\n                  }}\n                  onSubmit={this.updateDeliveryInstructions}\n                />\n              </div>\n            </>\n          }\n          progressComponent={<Loading />}\n          columns={this.columns}\n          data={data}\n          pagination={true}\n        />\n\n      </div>\n    );\n  }\n}\n\nexport default withSnackbar(DeliveryInstructions);\n"],"sourceRoot":""}