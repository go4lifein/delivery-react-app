(this["webpackJsonpdelivery-crm"]=this["webpackJsonpdelivery-crm"]||[]).push([[44],{1005:function(t,e,n){"use strict";n.r(e);var a=n(155),r=n.n(a),i=n(156),c=n(160),s=n(162),o=n(164),u=n(165),l=n(2),d=n(0),h=n.n(d),b=n(1023),p=n(42),j=n(204),f=n.n(j),m=n(58),v=n(26),O=n(259),x=n(898),g=n.n(x),y=(n(899),n(535)),C=n(407),k=n.n(C),w=n(401),D=n(984),S=n(890),I=n(3),q=n(977),L=n(986),P=n(985);var R=function(t){var e=t.onSubmit,n=t.onCancel,a=t.label,r=void 0===a?"Submit":a,i=t.message,c=void 0===i?"Are you sure you want to proceed?":i,s=t.confirmLabel,o=void 0===s?"Yes, proceed":s,u=t.cancelLabel,d=void 0===u?"Cancel":u,b=t.alertTitle,p=Object(O.a)(t,["onSubmit","onCancel","label","message","confirmLabel","cancelLabel","alertTitle"]),j=h.a.useState(!1),f=Object(v.a)(j,2),m=f[0],x=f[1];return Object(l.jsxs)("div",{children:[Object(l.jsxs)(w.a,{open:m,onClose:function(){return x(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[b&&Object(l.jsx)(D.a,{id:"alert-dialog-title",children:b}),Object(l.jsx)(S.a,{children:Object(l.jsx)(P.a,{id:"alert-dialog-description",children:c})}),Object(l.jsxs)(L.a,{children:[Object(l.jsx)(q.a,{onClick:n,color:"primary",children:d}),Object(l.jsx)(q.a,{onClick:e,color:"primary",variant:"contained",autoFocus:!0,children:o})]})]}),Object(l.jsx)(q.a,Object(I.a)(Object(I.a)({variant:"contained",color:"primary"},p),{},{onClick:function(){return x(!0)},children:r}))]})},F=n(966),N={header:!0,dynamicTyping:!0,skipEmptyLines:!0,transformHeader:function(t){return t.replace(/\W/g,"_")}};var T=function(t){t.hints;var e=t.label,n=void 0===e?"Upload File":e,a=t.papaparseOptions,r=void 0===a?N:a,i=t.validator,c=t.maxLength,s=t.filterDataCallback,o=t.mapDataCallback,u=(t.tableProps,t.onSubmit),h=(Object(O.a)(t,["hints","label","papaparseOptions","validator","maxLength","filterDataCallback","mapDataCallback","tableProps","onSubmit"]),Object(d.useState)([])),b=Object(v.a)(h,2),p=b[0],j=b[1],m=Object(d.useState)(!1),x=Object(v.a)(m,2),C=x[0],I=x[1],L=Object(d.useState)(null),P=Object(v.a)(L,2),T=P[0],E=P[1],H=Object(d.useState)(void 0),W=Object(v.a)(H,2),U=W[0],A=W[1],J=Object(d.useState)(null),V=Object(v.a)(J,2),Y=V[0],_=V[1];return Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{className:"flex middle",children:Object(l.jsx)(g.a,{cssClass:"csv-reader-input",label:Object(l.jsxs)("div",{className:"flex center middle",style:{fontSize:16},children:[" ",Object(l.jsx)(k.a,{style:{marginRight:8}})," ",n]}),onFileLoaded:function(t,e){!function(t){s&&(t=t.filter(s)),o&&(t=t.map(o));var e={};t.length&&(e=t[0]);var n=Object.keys(e).map((function(t){return{name:t,selector:t,width:"200px",sortable:!0}})),a=!1;c&&(a=!0,c=parseInt(c),t.length>c&&_("Total number of records can't exceed ".concat(c,". You added ").concat(t.length,"."))),i&&(t.forEach((function(t){try{i(t)}catch(e){console.log(t),a=!0,_(e.message)}})),a||_(null)),A(n),j(t),I(!0)}(t),E(e)},cssLabelClass:"csv-input-label",cssInputClass:"csv-input",parserOptions:r})}),C&&Object(l.jsxs)(w.a,{fullScreen:!0,open:C,children:[Object(l.jsx)(D.a,{children:Object(l.jsxs)("div",{className:"flex space-bw middle",children:[Object(l.jsxs)("div",{children:["Preview Data - ",Object(l.jsx)("span",{style:{padding:4,backgroundColor:"lightgreen",borderRadius:4},children:T&&T.name})]}),Object(l.jsxs)("div",{className:"flex middle",children:[Y&&Object(l.jsx)(y.a,{variant:"standard",severity:"error",children:Y}),Object(l.jsx)(R,{onSubmit:function(t){u&&u(p),I(!1)},disabled:Boolean(Y),onCancel:function(){return I(!1)},children:"Submit"}),Object(l.jsx)(q.a,{onClick:function(){return I(!1)},children:"Cancel"})]})]})}),Object(l.jsx)(F.a,{}),Object(l.jsx)(S.a,{children:Object(l.jsx)(f.a,{fixedHeader:!0,noHeader:!0,columns:U,data:p,pagination:!0})})]})]})},E=n(30),H=n.n(E),W=n(44),U=n(74),A=n(22),J=new function t(e){var n=this;Object(c.a)(this,t),this.addDriverData=function(t){return n.api.putRequest(n.path+"/addDeliveryPerson",t)},this.updateDeliveryInstructions=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return n.api.postRequest(n.path+"/updateDeliveryInstructions",{instructions:t})},this.getCustomersWithInstructions=function(){return n.api.get(n.path+"/getCustomersWithInstructions")},this.api=e,this.path="/delivery"}(new(function(){function t(e){var n=this;Object(c.a)(this,t),this.getRequestParam=function(){var t=Object(i.a)(r.a.mark((function t(e,a){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){n.api.request({url:e,method:"get",params:a}).then((function(e){return t(e.data)})).catch((function(t){U.a.dispatch(Object(W.a)(t)),r(t)}))})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.get=function(t){return new Promise((function(e,a){n.api.request({url:t,method:"get"}).then((function(t){return e(t.data)})).catch((function(t){U.a.dispatch(Object(W.a)(t)),a(t)}))}))},this.postRequest=function(t,e){return new Promise((function(a,r){n.api.request({url:t,method:"post",data:e}).then((function(t){return a(t.data)})).catch((function(t){U.a.dispatch(Object(W.a)(t)),r(t)}))}))},this.setRequestAuthHeader=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x-admin-token",e=arguments.length>1?arguments[1]:void 0;H.a.defaults.headers.common[t]=e},this.api=H.a.create(e)}return Object(s.a)(t,[{key:"putRequest",value:function(t,e){var n=this;return new Promise((function(a,r){n.api.request({url:t,method:"put",data:e}).then((function(t){return a(t.data)})).catch((function(t){U.a.dispatch(Object(W.a)(t)),r(t)}))}))}},{key:"postFormData",value:function(t,e){var n=this;return new Promise((function(a,r){n.api.post(t,{data:e,headers:{"Content-type":"multipart/form-data"}}).then((function(t){return a(t.data)})).catch((function(t){U.a.dispatch(Object(W.a)(t)),r(t)}))}))}}]),t}())({baseURL:A.a,headers:{"Content-Type":"application/json",timeout:500}})),V=function(t){Object(o.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).refreshData=Object(i.a)(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J.getCustomersWithInstructions();case 2:e=t.sent,a.setState({customers:e});case 4:case"end":return t.stop()}}),t)}))),a.filterData=function(){var t=a.state,e=t.search,n=t.customers,r=[];return n&&(r=n.filter((function(t){return!(!t.name.includes(e)&&!t.phone.includes(e))}))),r},a.columns=[{name:"Customer",selector:"name",sortable:!0,width:"300px"},{name:"Instruction",selector:"delivery_instruction",sortable:!0,width:"300px"}],a.onSearch=function(t){a.setState({search:t.target.value})},a.updateDeliveryInstructions=function(t){J.updateDeliveryInstructions(t).then((function(t){a.props.enqueueSnackbar(t,{variant:"success"})}))},a.validateInstructions=function(t){var e=t.id,n=t.instruction;if(!e)throw new Error("Column id is compulsory.");if(!n)throw new Error("Column instruction is compulsory.")},a.filterValidInstructions=function(t){var e=t.instruction;return!!t.id&&!!e},a.state={loading:!0,name:"",phone:"",search:"",customers:[]},a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.setState({loading:!1}),this.refreshData()}},{key:"render",value:function(){var t=this.state.loading,e=this.filterData();return t?Object(l.jsx)(m.a,{}):Object(l.jsx)("div",{children:Object(l.jsx)(f.a,{title:"Customer Delivery Instructions",actions:Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{children:Object(l.jsx)(b.a,{label:"Search by Name or Phone",value:this.state.search,onChange:this.onSearch})}),Object(l.jsx)("div",{children:Object(l.jsx)(T,{label:"Upload Delivery Instructions",maxLength:400,filterDataCallback:this.filterValidInstructions,validator:this.validateInstructions,mapDataCallback:function(t){var e=t.id,n=t.instruction;return{id:e,instruction:n=n.replace("'","")}},onSubmit:this.updateDeliveryInstructions})})]}),progressComponent:Object(l.jsx)(m.a,{}),columns:this.columns,data:e,pagination:!0})})}}]),n}(d.Component);e.default=Object(p.c)(V)},899:function(t,e,n){}}]);
//# sourceMappingURL=44.cbb7f295.chunk.js.map