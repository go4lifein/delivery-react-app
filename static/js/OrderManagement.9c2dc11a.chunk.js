(this["webpackJsonpdelivery-crm"]=this["webpackJsonpdelivery-crm"]||[]).push([[13],{173:function(e,t,r){"use strict";t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export.csv",r=document.createElement("a"),a=[];e.forEach((function(e){e=e.join(","),a.push(e)}));var n=a.join("\n");null!=n&&(n.match(/^data:text\/csv/i)||(n="data:text/csv;charset=utf-8,".concat(n)),r.setAttribute("href",encodeURI(n)),r.setAttribute("download",t),r.click())}},573:function(e,t,r){"use strict";r.r(t);var a=r(105),n=r(106),c=r(107),l=r(108),i=r(10),s=r(2),d=r(0),o=r.n(d),u=r(39),h=r(561),j=r(584),b=r(239),v=r(542),O=r(543),f=r(581),x=r(173),m=r(562),p=r(40),g=r(111),y=r(528),w=r(186),C=r.n(w),A=r(236),D=r.n(A),S=r(569),I=r(237),R=r.n(I),H=Object(s.jsx)(R.a,{});function N(e){var t=e.data,r=(e.onRowSelect,e.onSelectionChange),a=e.deliveryBoys;console.log(a);var n=[{name:"Order Id",selector:"orderId",sortable:!0,width:"130px"},{name:"Name",selector:"name",sortable:!0,width:"200px"},{name:"Phone",selector:"phone",sortable:!0,width:"140px"},{name:"Hub",sortable:!0,selector:"region",width:"100px"},{name:"Area",sortable:!0,selector:"area",width:"140px"},{name:"Locality",sortable:!0,selector:"subarea",width:"150px"},{name:"House",selector:"address",width:"300px"},{name:"Driver",selector:"_driver",cell:function(e,t){var r=e.driverId;if(r){var n=a.get(r);return n?n.name:""}return""}}];return Object(s.jsx)("div",{children:Object(s.jsx)(D.a,{striped:!0,noHeader:!0,selectableRows:!0,onSelectedRowsChange:r,dense:!0,selectableRowsComponent:S.a,sortIcon:H,data:t,columns:n,highlightOnHover:!0,pointerOnHover:!0,pagination:!0,paginationPerPage:10})})}var k=o.a.memo(N),B=r(266),E=r(146);var L=Object(u.b)((function(e){var t=e.setAdmin;return Object(i.a)({},t)}),(function(e){return{onUpdateOrdersData:function(t){return e(Object(E.d)(t))}}}))((function(e){var t=e.data,r=e.deliveryBoys,a=e.onUpdateOrdersData,n=Array.from(r.values());n=n.sort((function(e,t){return e.name.localeCompare(t.name)}));var c=Object(d.useState)([]),l=Object(g.a)(c,2),i=l[0],o=l[1],u=Object(d.useState)(!1),f=Object(g.a)(u,2),x=(f[0],f[1]),m=Object(d.useCallback)((function(e){x(e)}),[]),p=Object(d.useCallback)((function(e){e.allSelected,e.selectedCount;var t=e.selectedRows;o(t)}),[]);return Object(s.jsxs)("div",{id:"assign-orders",children:[Object(s.jsx)(y.a,{}),Object(s.jsx)("div",{className:"flex space-bw middle p-10",children:Object(s.jsxs)("div",{className:"flex right middle",children:[Object(s.jsxs)(v.a,{size:"small",children:[Object(s.jsx)(j.a,{id:"driver-filter",children:"Select Driver"}),Object(s.jsxs)(h.a,{labelId:"driver-filter",style:{width:200},disabled:i.length<1,onChange:function(e){var t={order_ids:i.map((function(e){return e.orderId})),driver:e.target.value};Object(B.a)(t).then((function(e){Object(B.b)().then((function(e){var t=e.data;a(t)})),o([])}))},children:[Object(s.jsx)(b.a,{value:"null",children:"None"}),n.map((function(e){return Object(s.jsx)(b.a,{value:e.id,children:e.name},"driver-".concat(e.id))}))]})]}),Object(s.jsxs)("div",{className:"p-10",children:[t.length," Customers Filtered"]}),Object(s.jsxs)("div",{className:"p-10",children:[i.length," Customers Selected"]}),Object(s.jsx)("div",{className:"p-10",children:Object(s.jsx)(O.a,{startIcon:Object(s.jsx)(C.a,{}),color:"secondary",variant:"outlined",onClick:e.exportData,children:"Download Excel"})})]})}),Object(s.jsx)(k,{data:t,onSelectionChange:p,onRowSelect:m,deliveryBoys:r})]})}));var P=function(e){Object(c.a)(r,e);var t=Object(l.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).hideAddress=function(){return n.setState({hiddenAddress:!0})},n.exportData=function(){var e=n.props.deliveryBoys,t=[["Order Id","Name","Phone","Hub","Area","Locality","House","Driver"]];n.filterData().forEach((function(r){var a=r.driverId,n="";a&&(n=e.get(a).name);var c=r.orderId,l=r.name,i=r.phone,s=r.region,d=r.area,o=r.subarea,u=r.address;t.push([c,'"'.concat(l,'"'),i,'"'.concat(s,'"'),'"'.concat(d,'"'),'"'.concat(o,'"'),'"'.concat(u.replace(/[^0-9a-zA-Z:/ ]/g,""),'"'),'"'.concat(n,'"')])})),Object(x.a)(t,"Delivery Sheet - ".concat((new Date).toLocaleDateString(),".csv"))},n.state={loading:!0,phone:"",selectedArea:[],selectedSubarea:"all",selectedHub:"all",selectedDriver:"all",showWithoutDairy:!1,hiddenAddress:!1,selectedRow:[]},n}return Object(n.a)(r,[{key:"filterData",value:function(){var e=this.state,t=e.selectedArea,r=e.selectedHub,a=e.selectedDriver,n=e.phone,c=this.props.orders,l=[];return c&&(l=c.filter((function(e){if("all"!==r&&e.address.hub!==r)return!1;if(t.length&&!t.includes(e.area))return!1;if("all"!==a)if("none"===a){if(null!==e.driverId)return!1}else if(e.driverId!==a)return!1;return!n||(-1!==e.phone.indexOf(n)||(-1!==e.name.toLowerCase().indexOf(n.toLowerCase())||-1!==e.orderId.toString().indexOf(n.toLowerCase())))}))),l}},{key:"render",value:function(){var e=this,t=!0,r=this.state,a=r.selectedArea,n=r.selectedHub,c=r.selectedDriver,l=r.phone,d=this.props,o=d.locations,u=d.hubs,x=d.deliveryBoys,g=d.orders,y=x?Array.from(x.values()):[];y=y.sort((function(e,t){return e.name.localeCompare(t.name)}));var w=[],C=[];o&&o.forEach((function(e,t){e.forEach((function(e,r){t!==n&&"all"!==n||w.push(r),(a.includes(r)||0===a.length)&&C.concat(e)}))})),w=w.sort((function(e,t){return e.localeCompare(t)})),g&&(t=!1);var A=this.filterData();return Object(s.jsx)("div",{children:t?Object(s.jsx)(p.a,{}):Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{className:"flex middle",style:{padding:10},children:[Object(s.jsx)("div",{style:{marginRight:20,width:220},children:Object(s.jsx)(f.a,{value:l,fullWidth:!0,label:"Phone, Name, Crate, Order Id",onChange:function(t){return e.setState({phone:t.target.value})}})}),Object(s.jsx)("div",{style:{marginRight:20,width:120},children:Object(s.jsxs)(v.a,{children:[Object(s.jsx)(j.a,{id:"hub-filter",children:"Hub"}),Object(s.jsxs)(h.a,{labelId:"hub-filter",style:{width:100},value:n,onChange:function(t){var r=t.target.value;e.setState({selectedHub:r,selectedArea:"all",selectedSubarea:"all"})},children:[Object(s.jsx)(b.a,{value:"all",children:"All"}),u.map((function(e){return Object(s.jsx)(b.a,{value:e,children:e},e)}))]})]})}),Object(s.jsx)("div",{style:{marginRight:20,width:450},children:Object(s.jsx)(v.a,{style:{width:"100%"},children:Object(s.jsx)(m.a,{labelId:"area-filter",options:w,multiple:!0,renderInput:function(e){return Object(s.jsx)(f.a,Object(i.a)(Object(i.a)({},e),{},{label:"Area"}))},onChange:function(t,r){console.log(r),e.setState({selectedArea:r,selectedSubarea:"all"})}})})}),Object(s.jsx)("div",{style:{marginRight:20},children:Object(s.jsxs)(v.a,{children:[Object(s.jsx)(j.a,{id:"driver-filter",children:"Assigned Driver"}),Object(s.jsxs)(h.a,{labelId:"driver-filter",style:{width:200},value:c||"all",onChange:function(t,r){var a=t.target.value;e.setState({selectedDriver:a})},children:[Object(s.jsx)(b.a,{value:"all",children:"All"}),Object(s.jsx)(b.a,{value:"none",children:"None"}),y.map((function(e){return Object(s.jsx)(b.a,{value:e.id,children:e.name},"driver-".concat(e.id))}))]})]})}),Object(s.jsx)("div",{style:{marginRight:20},children:Object(s.jsx)(O.a,{color:"primary",onClick:function(){window.location.reload()},children:"Clear All Filters"})})]}),Object(s.jsx)(L,{data:A,exportData:this.exportData,deliveryBoys:x})]})})}}]),r}(d.Component);t.default=Object(u.b)((function(e){var t=e.setAdmin;return Object(i.a)({},t)}))(P)}}]);
//# sourceMappingURL=OrderManagement.9c2dc11a.chunk.js.map