(this["webpackJsonpdelivery-crm"]=this["webpackJsonpdelivery-crm"]||[]).push([[11],{143:function(e,t,a){"use strict";t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"export.csv",a=document.createElement("a"),r=[];e.forEach((function(e){e=e.join(","),r.push(e)}));var c=r.join("\n");null!=c&&(c.match(/^data:text\/csv/i)||(c="data:text/csv;charset=utf-8,".concat(c)),a.setAttribute("href",encodeURI(c)),a.setAttribute("download",t),a.click())}},177:function(e,t,a){"use strict";var r=a(1),c=a(5),o=a(0),n=(a(10),a(29)),l=a(129),i=a(20),s=a(528),d=a(38),u=o.forwardRef((function(e,t){e.checked;var a=e.classes,i=e.className,u=e.control,h=e.disabled,p=(e.inputRef,e.label),b=e.labelPlacement,m=void 0===b?"end":b,f=(e.name,e.onChange,e.value,Object(c.a)(e,["checked","classes","className","control","disabled","inputRef","label","labelPlacement","name","onChange","value"])),g=Object(l.a)(),j=h;"undefined"===typeof j&&"undefined"!==typeof u.props.disabled&&(j=u.props.disabled),"undefined"===typeof j&&g&&(j=g.disabled);var v={disabled:j};return["checked","name","onChange","value","inputRef"].forEach((function(t){"undefined"===typeof u.props[t]&&"undefined"!==typeof e[t]&&(v[t]=e[t])})),o.createElement("label",Object(r.a)({className:Object(n.a)(a.root,i,"end"!==m&&a["labelPlacement".concat(Object(d.a)(m))],j&&a.disabled),ref:t},f),o.cloneElement(u,v),o.createElement(s.a,{component:"span",className:Object(n.a)(a.label,j&&a.disabled)},p))}));t.a=Object(i.a)((function(e){return{root:{display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,"&$disabled":{cursor:"default"}},labelPlacementStart:{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},labelPlacementTop:{flexDirection:"column-reverse",marginLeft:16},labelPlacementBottom:{flexDirection:"column",marginLeft:16},disabled:{},label:{"&$disabled":{color:e.palette.text.disabled}}}}),{name:"MuiFormControlLabel"})(u)},195:function(e,t,a){"use strict";var r=a(97),c=a(98);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=c(a(0)),n=(0,r(a(100)).default)(o.createElement("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward");t.default=n},196:function(e,t,a){"use strict";var r=a(1),c=a(5),o=a(0),n=(a(10),a(29)),l=a(20),i=a(23),s=a(38),d=a(124),u=o.forwardRef((function(e,t){var a=e.classes,l=e.className,i=e.color,u=void 0===i?"secondary":i,h=e.edge,p=void 0!==h&&h,b=e.size,m=void 0===b?"medium":b,f=Object(c.a)(e,["classes","className","color","edge","size"]),g=o.createElement("span",{className:a.thumb});return o.createElement("span",{className:Object(n.a)(a.root,l,{start:a.edgeStart,end:a.edgeEnd}[p],"small"===m&&a["size".concat(Object(s.a)(m))])},o.createElement(d.a,Object(r.a)({type:"checkbox",icon:g,checkedIcon:g,classes:{root:Object(n.a)(a.switchBase,a["color".concat(Object(s.a)(u))]),input:a.input,checked:a.checked,disabled:a.disabled},ref:t},f)),o.createElement("span",{className:a.track}))}));t.a=Object(l.a)((function(e){return{root:{display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},edgeStart:{marginLeft:-8},edgeEnd:{marginRight:-8},switchBase:{position:"absolute",top:0,left:0,zIndex:1,color:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[400],transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),"&$checked":{transform:"translateX(20px)"},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{opacity:.5},"&$disabled + $track":{opacity:"light"===e.palette.type?.12:.1}},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(i.c)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.primary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(i.c)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.secondary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},sizeSmall:{width:40,height:24,padding:7,"& $thumb":{width:16,height:16},"& $switchBase":{padding:4,"&$checked":{transform:"translateX(16px)"}}},checked:{},disabled:{},input:{left:"-100%",width:"300%"},thumb:{boxShadow:e.shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"},track:{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white,opacity:"light"===e.palette.type?.38:.3}}}),{name:"MuiSwitch"})(u)},547:function(e,t,a){"use strict";a.r(t);var r=a(32),c=a(105),o=a(106),n=a(107),l=a(108),i=a(4),s=a(2),d=a(0),u=a(39),h=a(194),p=a.n(h),b=a(178),m=a.n(b),f=a(544),g=a(195),j=a.n(g),v=a(143),y=a(70),O=a(581),x=a(177),w=a(196),C=a(140),k=a(171),S=a(40);var D=function(e){Object(n.a)(a,e);var t=Object(l.a)(a);function a(e){var o;return Object(c.a)(this,a),(o=t.call(this,e)).updateState=function(e){o.setState({selectedRows:e.selectedRows})},o.createCrateNumbers=function(){if(new Date(localStorage.getItem("cratesLastCreated",(new Date).toISOString()))>(new Date).setHours(0))alert("Crates IDs Already created");else{localStorage.setItem("cratesLastCreated",(new Date).toISOString()),o.setState({creatingCrate:!0});var e=o.props.customers,t=[];e.forEach((function(e){var a=e.order_id,r=e.crateId;t.push({order_id:a,crate_id:r})})),Object(k.f)({orderCrateIds:t}).then((function(e){window.location.reload()}))}},o.columns=[{name:"Crate",selector:"crate_id",sortable:!0,width:"90px"},{name:"Order Id",selector:"order_id",sortable:!0,width:"90px"},{name:"Hub",sortable:!0,width:"100px",cell:function(e,t){return e.address.hub}},{name:"Name",selector:"name",sortable:!0,width:"200px"},{name:"Phone",selector:"phone",sortable:!0,width:"140px"},{name:"Product",selector:"products",sortable:!1,cell:function(e,t){var a=e.phone,r=e.allProducts;return Object(s.jsxs)("table",{style:{width:"100%",textAlign:"left"},id:"customer-sheet-table",children:[Object(s.jsx)("thead",{children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Name"}),Object(s.jsx)("th",{children:"Total"}),Object(s.jsx)("th",{children:"Qty"})]})}),Object(s.jsx)("tbody",{children:r.map((function(e){var t=e.total,r=e.unit,c=e.quantity,o=e.product;return Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:o}),Object(s.jsxs)("td",{className:"fixed-width-column",children:[t," ",r]}),Object(s.jsx)("td",{className:"fixed-width-column",children:c})]},a.toString()+Math.random().toString())}))})]})}}],o.exportData=function(){var e=o.props.customers,t=Array.from(e.values()),a=o.state.removeSelectedDairy;t.sort((function(e,t){return e.crate_id-t.crate_id}));var c=[["Crate","Hub","Name","Phone","Address","Product","Category","Total","Qty"]];t.forEach((function(e){var t=e.products,o=e.phone,n=e.address,l=n.house_number,i=n.subarea,s=n.area,d=n.hub,u='"'.concat(l,", ").concat(i,", ").concat(s,'"'),h=Object.entries(t),p=[];h.forEach((function(e){var t=Object(r.a)(e,2),c=t[0];t[1].forEach((function(e){e.category=c,a&&(e.product.toLowerCase().includes("milk")||e.product.toLowerCase().includes("paneer"))||p.push(e)}))})),p.forEach((function(t,a){var r=t.total,n=t.unit,l=t.quantity,i=t.category;if(0===a){var s=[e.crate_id,"".concat(d),"".concat(e.name),"".concat(o),u,'"'.concat(t.product,'"'),"".concat(i),"".concat(r," ").concat(n),"".concat(l)];c.push(s)}else{var h=["","","","","",'"'.concat(t.product,'"'),"".concat(i),"".concat(r," ").concat(n),"".concat(l)];c.push(h)}}))})),Object(v.a)(c,"Customer Sheet - ".concat((new Date).toLocaleDateString(),".csv"))},o.state={loading:!0,removeSelectedDairy:!0},o}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.alreadyCreatedCratedToday,t=new Date(localStorage.getItem("cratesLastCreated"));if(t){t=new Date(t);var a=(new Date).setHours(0);console.log(a,t.valueOf()),t>a&&(e=!0)}this.setState({alreadyCreatedCratedToday:e})}},{key:"render",value:function(){var e=this,t=!0,a=this.props.customers,c=this.state,o=c.creatingCrate,n=c.removeSelectedDairy,l=c.search,i=c.alreadyCreatedCratedToday;i=i||this.props.alreadyCreatedCratedToday;var d=[];return a&&(t=!1,(d=Array.from(a.values())).forEach((function(e){var t=e.products,a=Object.entries(t),c=[];a.forEach((function(e){var t=Object(r.a)(e,2),a=t[0];t[1].forEach((function(e){e.category=a,n&&(e.product.toLowerCase().includes("milk")||e.product.toLowerCase().includes("paneer"))||c.push(e)}))})),e.allProducts=c})),d=d.filter((function(e){var t=e.name,a=e.phone,r=e.allProducts,c=e.crate_id;return 0!==r.length&&(i?!!c:!l||(!!t.toLowerCase().includes(l.toLowerCase())||!!a.toLowerCase().includes(l.toLowerCase())))}))),Object(s.jsx)("div",{children:t?Object(s.jsx)(S.a,{}):Object(s.jsx)("div",{id:"customer-sheet-table",style:{minWidth:1e3},children:Object(s.jsx)(p.a,{data:d,columns:this.columns,sortIcon:Object(s.jsx)(j.a,{}),actions:Object(s.jsxs)("div",{className:"flex middle",children:[Object(s.jsx)(O.a,{label:"Search Customer",style:{marginRight:10},onChange:function(t){e.setState({search:t.target.value})}}),Object(s.jsx)(x.a,{control:Object(s.jsx)(w.a,{checked:n,onChange:function(t,a){return e.setState({removeSelectedDairy:a})},color:"primary"}),label:"Remove Milk and Paneer"}),Object(s.jsx)(f.a,{variant:"outlined",color:"primary",startIcon:o?Object(s.jsx)(y.a,{size:12}):null,disabled:o||i,style:{marginRight:4},onClick:this.createCrateNumbers,children:"Create Crate Numbers"}),Object(s.jsx)(f.a,{startIcon:Object(s.jsx)(m.a,{}),color:"secondary",variant:"outlined",onClick:this.exportData,children:"Download Excel"})]})})})})}}]),a}(d.Component);t.default=Object(u.b)((function(e){var t=e.setAdmin;return Object(i.a)({},t)}),(function(e){return{onUpdateOrdersData:function(t){return e(Object(C.h)(t))}}}))(D)}}]);
//# sourceMappingURL=CustomerSheet.2d442803.chunk.js.map